package org.vizzini.starfightersquadrons.reporter;

import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertThat;

import java.io.StringWriter;

import org.junit.Test;
import org.vizzini.starfightersquadrons.reporter.PilotReporter;

/**
 * Provides tests for the <code>PilotReporter</code> class.
 */
public final class PilotReporterTest
{
    /**
     * Test the <code>report()</code> method.
     */
    @Test
    public void report()
    {
        // Setup.
        final PilotReporter reporter = new PilotReporter();
        final StringWriter writer = new StringWriter();

        // Run.
        reporter.report(writer);
        final String result = writer.toString();

        // Verify.
        assertNotNull(result);
        final String expected = "                                               Pilot  Primary                         Squad Offense Defense \n         Pilot                   Ship          Skill  Weapon  Agility  Hull   Shield  Cost  Ratio   Ratio  \n======================== ==================== ======= ======= ======= ======= ======= ==== ======= ======= \n      Outer Rim Smuggler       YT-1300              1       2       1       6       4   27    0.11    0.41\n    Delta Squadron Pilot     TIE Defender           1       3       3       3       3   30    0.13    0.30\n    Knave Squadron Pilot        E-Wing              1       3       3       2       3   27    0.15    0.30\n         Prototype Pilot        A-Wing              1       2       3       2       2   17    0.18    0.41\n           Bounty Hunter     Firespray-31           3       3       2       6       4   33    0.18    0.36\n     Onyx Squadron Pilot     TIE Defender           3       3       3       3       3   32    0.19    0.28\n               Chewbacca       YT-1300              5       3       1       8       5   42    0.19    0.33\n  Tempest Squadron Pilot     TIE Advanced           2       2       3       3       2   21    0.19    0.38\n         Rebel Operative       HWK-290              2       1       2       4       1   16    0.19    0.44\nBlackmoon Squadron Pilot        E-Wing              3       3       3       2       3   29    0.21    0.28\n    Alpha Squadron Pilot   TIE Interceptor          1       3       3       3       0   18    0.22    0.33\n          Krassis Trelix     Firespray-31           5       3       2       6       4   36    0.22    0.33\n     Gold Squadron Pilot        Y-Wing              2       2       1       5       3   18    0.22    0.50\n        Lando Calrissian       YT-1300              7       3       1       8       5   44    0.23    0.32\n     Blue Squadron Pilot        B-Wing              2       3       1       3       5   22    0.23    0.41\n            Rookie Pilot        X-Wing              2       3       2       3       2   21    0.24    0.33\n     Omicron Group Pilot Lambda-class Shuttle       2       3       1       5       5   21    0.24    0.52\n            Etahn A'baht        E-Wing              5       3       3       2       3   32    0.25    0.25\n           Academy Pilot     TIE Fighter            1       2       3       3       0   12    0.25    0.50\n Scimitar Squadron Pilot      TIE Bomber            2       2       2       6       0   16    0.25    0.50\n         Colonel Vessery     TIE Defender           6       3       3       3       3   35    0.26    0.26\n                Han Solo       YT-1300              9       3       1       8       5   46    0.26    0.30\n              Tarn Mison        X-Wing              3       3       2       3       2   23    0.26    0.30\n            Kath Scarlet     Firespray-31           7       3       2       6       4   38    0.26    0.32\n    Storm Squadron Pilot     TIE Advanced           4       2       3       3       2   23    0.26    0.35\n    Green Squadron Pilot        A-Wing              3       2       3       2       2   19    0.26    0.37\n            Roark Garnet       HWK-290              4       1       2       4       1   19    0.26    0.37\n    Sigma Squadron Pilot     TIE Phantom            3       4       2       2       2   25    0.28    0.24\n               Boba Fett     Firespray-31           8       3       2       6       4   39    0.28    0.31\n   Dagger Squadron Pilot        B-Wing              4       3       1       3       5   24    0.29    0.38\n            Captain Yorr Lambda-class Shuttle       4       3       1       5       5   24    0.29    0.46\n            Rexler Brath     TIE Defender           8       3       3       3       3   37    0.30    0.24\n  Avenger Squadron Pilot   TIE Interceptor          3       3       3       3       0   20    0.30    0.30\n      Red Squadron Pilot        X-Wing              4       3       2       3       2   23    0.30    0.30\n     Gray Squadron Pilot        Y-Wing              4       2       1       5       3   20    0.30    0.45\n             Corran Horn        E-Wing              8       3       3       2       3   35    0.31    0.23\n       Biggs Darklighter        X-Wing              5       3       2       3       2   25    0.32    0.28\n        \"Hobbie\" Klivian        X-Wing              5       3       2       3       2   25    0.32    0.28\n                 Ibtisam        B-Wing              6       3       1       3       5   28    0.32    0.32\n                  \"Echo\"     TIE Phantom            6       4       2       2       2   30    0.33    0.20\n   Shadow Squadron Pilot     TIE Phantom            5       4       2       2       2   27    0.33    0.22\n    Saber Squadron Pilot   TIE Interceptor          4       3       3       3       0   21    0.33    0.29\n    Saber Squadron Pilot  Saber Squadron TIE        4       3       3       3       0   21    0.33    0.29\n            Maarek Stele     TIE Advanced           7       2       3       3       2   27    0.33    0.30\n             Kyle Katarn       HWK-290              6       1       2       4       1   21    0.33    0.33\n    Gamma Squadron Pilot      TIE Bomber            4       2       2       6       0   18    0.33    0.44\n   Bandit Squadron Pilot   Z-95 Headhunter          2       2       2       2       2   12    0.33    0.50\n               \"Whisper\"     TIE Phantom            7       4       2       2       2   32    0.34    0.19\n           \"Fel's Wrath\"   TIE Interceptor          5       3       3       3       0   23    0.35    0.26\n       Lieutenant Lorrir  Saber Squadron TIE        5       3       3       3       0   23    0.35    0.26\n            Garven Dreis        X-Wing              6       3       2       3       2   26    0.35    0.27\n            Arvel Crynyd        A-Wing              6       2       3       2       2   23    0.35    0.30\n            Major Rhymer      TIE Bomber            7       2       2       6       0   26    0.35    0.31\n          \"Dutch\" Vander        Y-Wing              6       2       1       5       3   23    0.35    0.39\n          Colonel Jendon Lambda-class Shuttle       6       3       1       5       5   26    0.35    0.42\n                Ten Numb        B-Wing              8       3       1       3       5   31    0.35    0.29\n                 Jan Ors       HWK-290              8       1       2       4       1   25    0.36    0.28\n           Captain Jonus      TIE Bomber            6       2       2       6       0   22    0.36    0.36\n              Wes Janson        X-Wing              8       3       2       3       2   29    0.38    0.24\n               Kir Kanos   Royal Guard TIE          6       3       3       3       0   24    0.38    0.25\n             Darth Vader     TIE Advanced           9       2       3       3       2   29    0.38    0.28\n             Jek Porkins        X-Wing              7       3       2       3       2   26    0.38    0.27\n            Tycho Celchu        A-Wing              8       2       3       2       2   26    0.38    0.27\n Obsidian Squadron Pilot     TIE Fighter            3       2       3       3       0   13    0.38    0.46\n          Luke Skywalker        X-Wing              8       3       2       3       2   28    0.39    0.25\n            Turr Phennir   TIE Interceptor          7       3       3       3       0   25    0.40    0.24\n             Horton Salm        Y-Wing              8       2       1       5       3   25    0.40    0.36\n            Captain Kagi Lambda-class Shuttle       8       3       1       5       5   27    0.41    0.41\n          Wedge Antilles        X-Wing              9       3       2       3       2   29    0.41    0.24\n       Royal Guard Pilot   Royal Guard TIE          6       3       3       3       0   22    0.41    0.27\n           Tetran Cowall  Saber Squadron TIE        7       3       3       3       0   24    0.42    0.25\n              Carnor Jax   Royal Guard TIE          8       3       3       3       0   26    0.42    0.23\n    Black Squadron Pilot     TIE Fighter            4       2       3       3       0   14    0.43    0.43\n             Soontir Fel   TIE Interceptor          9       3       3       3       0   27    0.44    0.22\n     Tala Squadron Pilot   Z-95 Headhunter          4       2       2       2       2   13    0.46    0.46\n       Lieutenant Blount   Z-95 Headhunter          6       2       2       2       2   17    0.47    0.35\n           \"Night Beast\"     TIE Fighter            5       2       3       3       0   15    0.47    0.40\n        \"Winged Gundark\"     TIE Fighter            5       2       3       3       0   15    0.47    0.40\n           \"Backstabber\"     TIE Fighter            6       2       3       3       0   16    0.50    0.38\n            \"Dark Curse\"     TIE Fighter            6       2       3       3       0   16    0.50    0.38\n           Airen Cracken   Z-95 Headhunter          8       2       2       2       2   19    0.53    0.32\n         \"Mauler Mithel\"     TIE Fighter            7       2       3       3       0   17    0.53    0.35\n            \"Howlrunner\"     TIE Fighter            8       2       3       3       0   18    0.56    0.33\n";
        // System.out.println("expected =\n" + expected);
        // System.out.println("result   =\n" + result);
        assertThat(result, is(expected));
    }

    /**
     * Test the <code>reportByTeam()</code> method.
     */
    @Test
    public void reportByTeam()
    {
        // Setup.
        final PilotReporter reporter = new PilotReporter();
        final StringWriter writer = new StringWriter();

        // Run.
        reporter.reportByTeam(writer);
        final String result = writer.toString();

        // Verify.
        assertNotNull(result);
        final String expected = "Team: Imperial\n                                               Pilot  Primary                         Squad Offense Defense \n         Pilot                   Ship          Skill  Weapon  Agility  Hull   Shield  Cost  Ratio   Ratio  \n======================== ==================== ======= ======= ======= ======= ======= ==== ======= ======= \n    Delta Squadron Pilot     TIE Defender           1       3       3       3       3   30    0.13    0.30\n           Bounty Hunter     Firespray-31           3       3       2       6       4   33    0.18    0.36\n     Onyx Squadron Pilot     TIE Defender           3       3       3       3       3   32    0.19    0.28\n  Tempest Squadron Pilot     TIE Advanced           2       2       3       3       2   21    0.19    0.38\n    Alpha Squadron Pilot   TIE Interceptor          1       3       3       3       0   18    0.22    0.33\n          Krassis Trelix     Firespray-31           5       3       2       6       4   36    0.22    0.33\n     Omicron Group Pilot Lambda-class Shuttle       2       3       1       5       5   21    0.24    0.52\n           Academy Pilot     TIE Fighter            1       2       3       3       0   12    0.25    0.50\n Scimitar Squadron Pilot      TIE Bomber            2       2       2       6       0   16    0.25    0.50\n         Colonel Vessery     TIE Defender           6       3       3       3       3   35    0.26    0.26\n            Kath Scarlet     Firespray-31           7       3       2       6       4   38    0.26    0.32\n    Storm Squadron Pilot     TIE Advanced           4       2       3       3       2   23    0.26    0.35\n    Sigma Squadron Pilot     TIE Phantom            3       4       2       2       2   25    0.28    0.24\n               Boba Fett     Firespray-31           8       3       2       6       4   39    0.28    0.31\n            Captain Yorr Lambda-class Shuttle       4       3       1       5       5   24    0.29    0.46\n            Rexler Brath     TIE Defender           8       3       3       3       3   37    0.30    0.24\n  Avenger Squadron Pilot   TIE Interceptor          3       3       3       3       0   20    0.30    0.30\n                  \"Echo\"     TIE Phantom            6       4       2       2       2   30    0.33    0.20\n   Shadow Squadron Pilot     TIE Phantom            5       4       2       2       2   27    0.33    0.22\n    Saber Squadron Pilot   TIE Interceptor          4       3       3       3       0   21    0.33    0.29\n    Saber Squadron Pilot  Saber Squadron TIE        4       3       3       3       0   21    0.33    0.29\n            Maarek Stele     TIE Advanced           7       2       3       3       2   27    0.33    0.30\n    Gamma Squadron Pilot      TIE Bomber            4       2       2       6       0   18    0.33    0.44\n               \"Whisper\"     TIE Phantom            7       4       2       2       2   32    0.34    0.19\n           \"Fel's Wrath\"   TIE Interceptor          5       3       3       3       0   23    0.35    0.26\n       Lieutenant Lorrir  Saber Squadron TIE        5       3       3       3       0   23    0.35    0.26\n            Major Rhymer      TIE Bomber            7       2       2       6       0   26    0.35    0.31\n          Colonel Jendon Lambda-class Shuttle       6       3       1       5       5   26    0.35    0.42\n           Captain Jonus      TIE Bomber            6       2       2       6       0   22    0.36    0.36\n               Kir Kanos   Royal Guard TIE          6       3       3       3       0   24    0.38    0.25\n             Darth Vader     TIE Advanced           9       2       3       3       2   29    0.38    0.28\n Obsidian Squadron Pilot     TIE Fighter            3       2       3       3       0   13    0.38    0.46\n            Turr Phennir   TIE Interceptor          7       3       3       3       0   25    0.40    0.24\n       Royal Guard Pilot   Royal Guard TIE          6       3       3       3       0   22    0.41    0.27\n            Captain Kagi Lambda-class Shuttle       8       3       1       5       5   27    0.41    0.41\n           Tetran Cowall  Saber Squadron TIE        7       3       3       3       0   24    0.42    0.25\n              Carnor Jax   Royal Guard TIE          8       3       3       3       0   26    0.42    0.23\n    Black Squadron Pilot     TIE Fighter            4       2       3       3       0   14    0.43    0.43\n             Soontir Fel   TIE Interceptor          9       3       3       3       0   27    0.44    0.22\n           \"Night Beast\"     TIE Fighter            5       2       3       3       0   15    0.47    0.40\n        \"Winged Gundark\"     TIE Fighter            5       2       3       3       0   15    0.47    0.40\n           \"Backstabber\"     TIE Fighter            6       2       3       3       0   16    0.50    0.38\n            \"Dark Curse\"     TIE Fighter            6       2       3       3       0   16    0.50    0.38\n         \"Mauler Mithel\"     TIE Fighter            7       2       3       3       0   17    0.53    0.35\n            \"Howlrunner\"     TIE Fighter            8       2       3       3       0   18    0.56    0.33\nTeam: Rebel\n                                               Pilot  Primary                         Squad Offense Defense \n         Pilot                   Ship          Skill  Weapon  Agility  Hull   Shield  Cost  Ratio   Ratio  \n======================== ==================== ======= ======= ======= ======= ======= ==== ======= ======= \n      Outer Rim Smuggler       YT-1300              1       2       1       6       4   27    0.11    0.41\n    Knave Squadron Pilot        E-Wing              1       3       3       2       3   27    0.15    0.30\n         Prototype Pilot        A-Wing              1       2       3       2       2   17    0.18    0.41\n               Chewbacca       YT-1300              5       3       1       8       5   42    0.19    0.33\n         Rebel Operative       HWK-290              2       1       2       4       1   16    0.19    0.44\nBlackmoon Squadron Pilot        E-Wing              3       3       3       2       3   29    0.21    0.28\n     Gold Squadron Pilot        Y-Wing              2       2       1       5       3   18    0.22    0.50\n        Lando Calrissian       YT-1300              7       3       1       8       5   44    0.23    0.32\n     Blue Squadron Pilot        B-Wing              2       3       1       3       5   22    0.23    0.41\n            Rookie Pilot        X-Wing              2       3       2       3       2   21    0.24    0.33\n            Etahn A'baht        E-Wing              5       3       3       2       3   32    0.25    0.25\n                Han Solo       YT-1300              9       3       1       8       5   46    0.26    0.30\n              Tarn Mison        X-Wing              3       3       2       3       2   23    0.26    0.30\n    Green Squadron Pilot        A-Wing              3       2       3       2       2   19    0.26    0.37\n            Roark Garnet       HWK-290              4       1       2       4       1   19    0.26    0.37\n   Dagger Squadron Pilot        B-Wing              4       3       1       3       5   24    0.29    0.38\n      Red Squadron Pilot        X-Wing              4       3       2       3       2   23    0.30    0.30\n     Gray Squadron Pilot        Y-Wing              4       2       1       5       3   20    0.30    0.45\n             Corran Horn        E-Wing              8       3       3       2       3   35    0.31    0.23\n       Biggs Darklighter        X-Wing              5       3       2       3       2   25    0.32    0.28\n        \"Hobbie\" Klivian        X-Wing              5       3       2       3       2   25    0.32    0.28\n                 Ibtisam        B-Wing              6       3       1       3       5   28    0.32    0.32\n             Kyle Katarn       HWK-290              6       1       2       4       1   21    0.33    0.33\n   Bandit Squadron Pilot   Z-95 Headhunter          2       2       2       2       2   12    0.33    0.50\n            Garven Dreis        X-Wing              6       3       2       3       2   26    0.35    0.27\n            Arvel Crynyd        A-Wing              6       2       3       2       2   23    0.35    0.30\n          \"Dutch\" Vander        Y-Wing              6       2       1       5       3   23    0.35    0.39\n                Ten Numb        B-Wing              8       3       1       3       5   31    0.35    0.29\n                 Jan Ors       HWK-290              8       1       2       4       1   25    0.36    0.28\n              Wes Janson        X-Wing              8       3       2       3       2   29    0.38    0.24\n             Jek Porkins        X-Wing              7       3       2       3       2   26    0.38    0.27\n            Tycho Celchu        A-Wing              8       2       3       2       2   26    0.38    0.27\n          Luke Skywalker        X-Wing              8       3       2       3       2   28    0.39    0.25\n             Horton Salm        Y-Wing              8       2       1       5       3   25    0.40    0.36\n          Wedge Antilles        X-Wing              9       3       2       3       2   29    0.41    0.24\n     Tala Squadron Pilot   Z-95 Headhunter          4       2       2       2       2   13    0.46    0.46\n       Lieutenant Blount   Z-95 Headhunter          6       2       2       2       2   17    0.47    0.35\n           Airen Cracken   Z-95 Headhunter          8       2       2       2       2   19    0.53    0.32\n";
        // System.out.println("expected =\n" + expected);
        // System.out.println("result   =\n" + result);
        assertThat(result, is(expected));
    }
}
