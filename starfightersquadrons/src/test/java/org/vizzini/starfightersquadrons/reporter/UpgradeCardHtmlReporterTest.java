package org.vizzini.starfightersquadrons.reporter;

import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertThat;

import java.io.File;
import java.io.IOException;
import java.io.StringWriter;
import java.io.Writer;

import org.apache.commons.io.FileUtils;
import org.junit.Test;

/**
 * Provides tests for the <code>UpgradeCardHtmlReporter</code> class.
 */
public final class UpgradeCardHtmlReporterTest
{
    /**
     * Test the <code>report()</code> method.
     */
    @Test
    public void report()
    {
        // Setup.
        final UpgradeCardHtmlReporter reporter = new UpgradeCardHtmlReporter();
        final Writer writer = new StringWriter();

        // Run.
        reporter.report(writer);

        // Verify.
        final String result = writer.toString();
        assertNotNull(result);
        // System.out.println("result =\n" + result);
        writeToFile(result);
        final String expected = "<html>\n<head>\n<link rel=\"stylesheet\" type=\"text/css\" href=\"https://dl.dropboxusercontent.com/u/1267954/website/includes/style.css\" />\n<title>Starfighter Squadrons: Upgrade Cards</title>\n<script src=\"sorttable.js\"></script><script src=\"https://dl.dropboxusercontent.com/u/1267954/website/includes/sorttable.js\"></script></head>\n<body>\n<p class=\"header1\">Upgrade Cards</p><table class=\"sortable table-details\">\n<tr>\n<th class=\"table-header-cell-details\">Name</th><th class=\"table-header-cell-details\">Type</th><th class=\"table-header-cell-details\">Restrictions</th><th class=\"table-header-cell-details\">Description</th><th class=\"table-header-cell-details\">Secondary<br/>Weapon</th><th class=\"table-header-cell-details\">Squad<br/>Point<br/>Cost</th><th class=\"table-header-cell-details\">Wave</th></tr>\n<tr>\n<td class=\"table-cell-details\">Adrenaline Rush</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When you reveal a red maneuver, you may discard this card to treat that manuever as a white maneuver until the end of the Activation phase.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Advanced Cloaking Device</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Modification. TIE Phantom only.</td><td class=\"table-cell-details\">After you perform an attack, you may perform a free cloak action.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Advanced Sensors</td><td class=\"table-cell-details\">Sensor</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">Immediately before you reveal your maneuver, you may perform 1 free action. If you use this ability, you must skip your \"Perform Action\" step during this round.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Anti-Pursuit Lasers</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Large Ship only. Modification.</td><td class=\"table-cell-details\">After an enemy ship executes a maneuver that causes it to overlap your ship, roll 1 attack die. On a Hit or Critical Hit result, the enemy ship suffers 1 damage.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">C-3PO</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Rebel only.</td><td class=\"table-cell-details\">Once per round, before you roll 1 or more defense dice, you may guess aloud a number of Evade results. If you roll that many Evade results (before modifying dice), add 1 Evade result.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Carlist Rieekan</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Huge Ship only. Rebel only.</td><td class=\"table-cell-details\">At the start of the Activation phase, you may discard this card to treat each friendly ship's pilot skill value as \"12\" until the end of the phase.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Chewbacca</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Rebel only.</td><td class=\"table-cell-details\">When you are dealt a Damage card, you may immediately discard that card and recover 1 shield. Then, discard this Upgrade card.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Combat Retrofit</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">GR-75 only. Huge Ship only. Modification.</td><td class=\"table-cell-details\">Increase your hull value by 2 and your shield value by 1.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">10</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Daredevil</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Execute a white Turn Left 1 or Turn Right 1 maneuver. Then, receive 1 stress token. Then, if you do no have the Boost action icon, roll 2 attack dice. Suffer any Damage and Critical Damage rolled.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Darth Vader</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Imperial only.</td><td class=\"table-cell-details\">After you perform an attack against an enemy ship, you may suffer 2 damage to cause that ship to suffer 1 critical damage.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Deadeye</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">You may treat the \"Attack [Target Lock]:\" header as \"Attack [Focus]:.\" When an attack instructs you to spend a target lock, you may spend a focus token instead.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Decoy</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">At the start of the Combat phase, you may choose 1 friendly ship at Range 1-2. Exchange your pilot skill with that ship's pilot skill until the end of the phase.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Determination</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When you are dealt a faceup Damage card with the Pilot trait, discard it immediately without resolving its effect.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">Core</td></tr>\n<tr>\n<td class=\"table-cell-details\">Draw Their Fire</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When a friendly ship at Range 1 is hit by an attack, you may suffer 1 of the uncanceled Critical Hit results instead of the target ship.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Elusiveness</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When defending, you may receive 1 stress token to choose 1 attack die. The attacker must reroll that die. If you have at least 1 stress token, you cannot use this ability.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Engine Upgrade</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Modification.</td><td class=\"table-cell-details\">Your action bar gains the boost action icon.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Engineering Team</td><td class=\"table-cell-details\">Team</td><td class=\"table-cell-details\">Limited.</td><td class=\"table-cell-details\">During the Activation phase, when you reveal a Straight maneuver, gain 1 additional energy during the \"Gain Energy\" step.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Expert Handling</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Perform a free barrel roll action. If you do not have the Barrel Roll action icon, receive 1 stress token. You may then remove 1 enemy target lock from your ship.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">Expose</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Until the end of the round, increase your primary weapon value by 1 and decrease your agility value by 1.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Fire Control System</td><td class=\"table-cell-details\">Sensor</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">After you perform an attack, you may acquire a target lock on the defender.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Flight Instructor</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When defending, you may reroll 1 of your Focus results. If the attacker's pilot skill value is \"2\" or lower, you may reroll 1 of your blank results instead.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Gunner</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">After you perform an attack that does not hit, you may immediately perform a primary weapon attack. You cannot perform another attack this round.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">5</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Gunnery Team</td><td class=\"table-cell-details\">Team</td><td class=\"table-cell-details\">Limited.</td><td class=\"table-cell-details\">Once per round, when attacking with a secondary weapon, you may spend 1 energy to change 1 of your blank results to a Hit result.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Han Solo</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Rebel only.</td><td class=\"table-cell-details\">When attacking, if you have a target lock on the defender, you may spend that target lock to change all of your Focus results to Hit results.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Hull Upgrade</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Modification.</td><td class=\"table-cell-details\">Increase your hull value by 1.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Intelligence Agent</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">At the start of the Activation phase, choose 1 enemy ship at Range 1-2. You may look at that ship's chosen maneuver.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Jan Dodonna</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Huge Ship only. Rebel only.</td><td class=\"table-cell-details\">When another friendly ship at Range 1 is attacking, it may change 1 of its Hit results to a Critical Hit result.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">6</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Leia Organa</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Rebel only.</td><td class=\"table-cell-details\">At the start of the Activation phase, you may discard this card to allow all friendly ships that reveal a red maneuver to treat that maneuver as a white maneuver until the end of the phase.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">6</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Luke Skywalker</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Rebel only.</td><td class=\"table-cell-details\">After you perform an attack that does not hit, you may immediately perform a primary weapon attack. You may change 1 Focus result to a Hit result. You cannot perform another attack this round.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">7</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Marksmanship</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> When attacking this round, you may change 1 of your Focus results to a Critical Hit result and all of your other Focus results to Hit results.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">Core</td></tr>\n<tr>\n<td class=\"table-cell-details\">Mercenary Copilot</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When attacking at Range 3, you may change 1 of your Hit results to a Critical Hit result.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Millennium Falcon</td><td class=\"table-cell-details\">Title</td><td class=\"table-cell-details\">Title. YT-1300 only.</td><td class=\"table-cell-details\">Your action bar gains the Evade action icon.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Moldy Crow</td><td class=\"table-cell-details\">Title</td><td class=\"table-cell-details\">HWK-290 only. Title.</td><td class=\"table-cell-details\">During the End phase, do not remove unused focus tokens from your ship.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Munitions Failsafe</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Modification.</td><td class=\"table-cell-details\">When attacking with a secondary weapon that instructs you to discard it to perform the attack, do not discard it unless the attack hits.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Navigator</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When you reveal a manuever you may rotate your dial to another maneuver with the same bearing. You cannot rotate to a red maneuver if you have any stress tokens.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Nien Nunb</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Rebel only.</td><td class=\"table-cell-details\">You may treat all Straight maneuvers as green maneuvers.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Opportunist</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When attacking, if the defender does not have any focus or evade tokens, you may receive 1 stress token to roll 1 additional attack die. You cannot use this ability if you have any stress tokens.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Outmaneuver</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When attacking a ship inside your firing arc, if you are not inside that ship's firing arc, reduce its agility value by 1 (to a minimum of 0).</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Predator</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When attacking, you may reroll 1 attack die. If the defender's pilot skill value if \"2\" or lower, you may instead reroll up to 2 attack dice.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Proton Bombs</td><td class=\"table-cell-details\">Bomb</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When you reveal your maneuver dial, you may discard this card to drop 1 proton bomb token. This token detonates at the end of the Activation phase.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">5</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Proximity Mines</td><td class=\"table-cell-details\">Bomb</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Discard this card to drop 1 proximity mine token. When a ship's base or maneuver template overlaps this token, this token detonates.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Push The Limit</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">Once per round, after you perform an action, you may perform 1 free action shown in your action bar. Then receive 1 stress token.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">R2 Astromech</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">You may treat all 1- and 2-speed maneuvers as green maneuvers.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">R2-D2</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">After executing a green maneuver, you may recover 1 shield (up to your shield value).</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">Core</td></tr>\n<tr>\n<td class=\"table-cell-details\">R2-D2 (Crew)</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Rebel only.</td><td class=\"table-cell-details\">At the end of the End phase, if you have no shields, you may recover 1 shield and roll 1 attack die. On a Hit result, randomly flip 1 of your facedown Damage cards faceup and resolve it.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">R2-D6</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">Your upgrade bar gains the Elite upgrade icon. You cannot equip this upgrade if you already have a Elite upgrade icon or if your pilot skill value is 2 or lower.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">R2-F2</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Increase your agility value by 1 until the end of this game round.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">Core</td></tr>\n<tr>\n<td class=\"table-cell-details\">R3-A2</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When you declare the target of your attack, if the defender is inside your firing arc, you may receive 1 stress token to cause the defender to receive 1 stress token.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">R4-D6</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When you are hit by an attack and there are at least 3 uncanceled hit results, you may choose and cancel those results until there are 2 remaining. For each result canceled in this way, receive 1 stress token.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">R5 Astromech</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">During the End phase, you may choose 1 of your faceup Damage cards with the Ship trait and flip it facedown.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">R5-D8</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Roll 1 defense die. On an evade or focus result, discard 1 of your facedown Damage cards.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">R5-K6</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">After spending your target lock, roll 1 defense die. On an evade result, immediately acquire a target lock on that same ship. You cannot spend this target lock during this attack.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">R5-P9</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">At the end of the Combat phase, you may spend 1 of your focus tokens to recover 1 shield (up to your shield value).</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">R7 Astromech</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">Once per round when defending, if you have a target lock on the attacker, you may spend the target lock to choose any or all attack dice. The attacker must reroll the chosen dice.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">R7-T1</td><td class=\"table-cell-details\">Astromech</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Choose an enemy ship at Range 1-2. If you are inside that ship's firing arc, you may acquire a target lock on that ship. Then you may perform a free boost action.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Raymus Antilles</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Huge Ship only. Rebel only.</td><td class=\"table-cell-details\">At the start of the Activation phase, choose 1 enemy ship at Range 1-3. You may look at that ship's chosen maneuver. If the maneuver is white, assign that ship 1 stress token.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">6</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Rebel Captive</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Imperial only.</td><td class=\"table-cell-details\">Once per round, the first ship that declares you as the target of an attack immediately receives 1 stress token.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Recon Specialist</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When you perform a focus action, assign 1 additional focus token to your ship.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Royal Guard TIE</td><td class=\"table-cell-details\">Title</td><td class=\"table-cell-details\">TIE Interceptor only. Title.</td><td class=\"table-cell-details\">You may equip up to 2 different Modification upgrades (instead of 1). You cannot equip this card if your pilot skill value is \"4\" or lower.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">0</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Saboteur</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Choose 1 enemy ship at Range 1 and roll 1 attack die. On a Hit or Critical Hit result, choose 1 random facedown Damage card assigned to that ship, flip it faceup, and resolve it.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Seismic Charges</td><td class=\"table-cell-details\">Bomb</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When you reveal your maneuver dial, you may discard this card to drop 1 seismic charge token. This token detonates at the end of the Activation phase.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Sensor Jammer</td><td class=\"table-cell-details\">Sensor</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When defending, you may change 1 of the attacker's Hit results to a Focus result. The attacker cannot reroll the die with the changed result.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Sensor Team</td><td class=\"table-cell-details\">Team</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">When acquiring a target lock, you may lock onto an enemy ship at Range 1-5 (instead of Range 1-3).</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Shield Upgrade</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Modification.</td><td class=\"table-cell-details\">Increase your shield value by 1.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Slave I</td><td class=\"table-cell-details\">Title</td><td class=\"table-cell-details\">Firespray-31 only. Title.</td><td class=\"table-cell-details\">Your upgrade bar gains the Torpedo upgrade icon.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">0</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Squad Leader</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Action:</b> Choose 1 ship at Range 1-2 that has a lower pilot skill than you. The chosen ship may immediately perform 1 free action.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">ST-321</td><td class=\"table-cell-details\">Title</td><td class=\"table-cell-details\">Lambda-class Shuttle only. Title.</td><td class=\"table-cell-details\">When acquiring a target lock, you may lock onto any enemy ship in the play area.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Stealth Device</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Modification.</td><td class=\"table-cell-details\">Increase your agility value by 1. If you are hit by an attack, discard this card.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Stygium Particle Accelerator</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Modification.</td><td class=\"table-cell-details\">When you either decloak or perform a cloak action, you may perform a free evade action.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Swarm Tactics</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">At the start of the Combat phase, you may choose 1 friendly ship at Range 1. Until the end of this phase, treat the chosen ship as if its pilot skill were equal to your pilot skill.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">Tactician</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">After you perform an attack against a ship inside your firing arc at Range 2, that ship receives 1 stress token.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Targeting Computer</td><td class=\"table-cell-details\">Modification</td><td class=\"table-cell-details\">Modification.</td><td class=\"table-cell-details\">Your action bar gains the Target Lock action icon.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Targeting Coordinator</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Limited.</td><td class=\"table-cell-details\"><b>Energy:</b> You may spend 1 energy to choose 1 friendly ship at Range 1-2. Acquire a target lock, then assign the blue target lock token to the chosen ship.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Toryn Farr</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Huge Ship only. Rebel only.</td><td class=\"table-cell-details\"><b>Action:</b> Spend any amount of energy to choose that many enemy ships at Range 1-2. Remove all focus, evade, and blue target lock tokens from those ships.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">6</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Veteran Instincts</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">Increase your pilot skill value by 2.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">1</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Weapons Engineer</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">You may maintain 2 target locks (only 1 per enemy ship). When you acquire a target lock, you may lock onto 2 different ships.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">WED-15 Repair Droid</td><td class=\"table-cell-details\">Crew</td><td class=\"table-cell-details\">Huge Ship only.</td><td class=\"table-cell-details\"><b>Action:</b> Spend 1 energy to discard 1 of your facedown Damage cards, or spend 3 energy to discard 1 of your faceup Damage cards.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">3.5</td></tr>\n<tr>\n<td class=\"table-cell-details\">Wingman</td><td class=\"table-cell-details\">Elite</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\">At the start of the Combat phase, remove 1 stress token from another friendly ship at Range 1.</td><td class=\"right table-cell-details\">&nbsp;</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Advanced Proton Torpedoes</td><td class=\"table-cell-details\">Torpedo</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Target Lock]:</b> Spend your target lock and discard this card to perform this attack. You may change up to 3 of your blank results to Focus results.</td><td class=\"right table-cell-details\">5</td><td class=\"right table-cell-details\">6</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Assault Missiles</td><td class=\"table-cell-details\">Missile</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Target Lock]:</b> Spend your target lock and discard this card to perform this attack. If this attack hits, each other ship at Range 1 of the defender suffers 1 damage.</td><td class=\"right table-cell-details\">4</td><td class=\"right table-cell-details\">5</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Autoblaster</td><td class=\"table-cell-details\">Cannon</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack:</b> Attack 1 ship. Your hit results cannot be canceled by defense dice. The token may cancel critical hit results before hit results.</td><td class=\"right table-cell-details\">3</td><td class=\"right table-cell-details\">5</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Blaster Turret</td><td class=\"table-cell-details\">Turret</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Focus]:</b> Spend 1 focus token to perform this attack against 1 ship (even a ship outside your firing arc).</td><td class=\"right table-cell-details\">3</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">3</td></tr>\n<tr>\n<td class=\"table-cell-details\">Cluster Missiles</td><td class=\"table-cell-details\">Missile</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Target Lock]:</b> Spend your target lock and discard this card to perform this attack twice.</td><td class=\"right table-cell-details\">3</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">Concussion Missiles</td><td class=\"table-cell-details\">Missile</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Target Lock]:</b> Spend your target lock and discard this card to perform this attack. You may change 1 of your blank results to a Hit result.</td><td class=\"right table-cell-details\">4</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">Flechette Torpedoes</td><td class=\"table-cell-details\">Torpedo</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Target Lock]:</b> Discard this card and spend your target lock to perform this attack. After you perform this attack, the defender receives 1 stress token if its hull value is \"4\" or lower.</td><td class=\"right table-cell-details\">3</td><td class=\"right table-cell-details\">2</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Heavy Laser Cannon</td><td class=\"table-cell-details\">Cannon</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack:</b> Attack 1 ship. Immediately after rolling your attack dice, you must change all of your critical hit results to hit results.</td><td class=\"right table-cell-details\">4</td><td class=\"right table-cell-details\">7</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Homing Missiles</td><td class=\"table-cell-details\">Missile</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Target Lock]:</b> Discard this card to perform this attack. The defender cannot spend evade tokens during this attack.</td><td class=\"right table-cell-details\">4</td><td class=\"right table-cell-details\">5</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Ion Cannon</td><td class=\"table-cell-details\">Cannon</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack:</b> Attack 1 ship. If this attack hits, the defender suffers 1 damage and receives 1 ion token. Then cancel all dice results.</td><td class=\"right table-cell-details\">3</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">2</td></tr>\n<tr>\n<td class=\"table-cell-details\">Ion Cannon Turret</td><td class=\"table-cell-details\">Turret</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack:</b> Attack 1 ship (even a ship outside your firing arc). If this attack hits the target ship, the ship suffers 1 damage and receives 1 ion token. Then cancel all dice results.</td><td class=\"right table-cell-details\">3</td><td class=\"right table-cell-details\">5</td><td class=\"table-cell-details\">1</td></tr>\n<tr>\n<td class=\"table-cell-details\">Ion Pulse Missiles</td><td class=\"table-cell-details\">Missile</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Target Lock]:</b> Spend your target lock and discard this card to perform this attack. If this attack hits, the defender suffers 1 damage and receives 2 ion tokens. Then cancel all dice results.</td><td class=\"right table-cell-details\">3</td><td class=\"right table-cell-details\">3</td><td class=\"table-cell-details\">4</td></tr>\n<tr>\n<td class=\"table-cell-details\">Proton Torpedoes</td><td class=\"table-cell-details\">Torpedo</td><td class=\"table-cell-details\">&nbsp;</td><td class=\"table-cell-details\"><b>Attack [Target Lock]:</b> Spend your target lock and discard this card to perform this attack. You may change 1 of your Focus results to a Critical Hit result.</td><td class=\"right table-cell-details\">4</td><td class=\"right table-cell-details\">4</td><td class=\"table-cell-details\">Core</td></tr>\n</table>\n</body>\n</html>\n";
        assertThat(result, is(expected));
    }

    /**
     * @param content Content.
     */
    private void writeToFile(final String content)
    {
        final File file = new File("upgradeCards.html");
        try
        {
            FileUtils.write(file, content);
        }
        catch (final IOException e)
        {
            throw new RuntimeException(e);
        }
    }
}
