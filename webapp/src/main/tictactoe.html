<html>
<head>
<meta charset="utf-8">
<title>Vizzini Tic-Tac-Toe</title>
<link rel="stylesheet" href="css/style.css">

<script src="js/util/Logger.js"></script>
<script src="js/util/ArrayAugments.js"></script>
<script src="js/util/HtmlUtilities.js"></script>
<script src="js/util/InputValidator.js"></script>
<script src="js/util/NumberAugments.js"></script>
<script src="js/util/StringAugments.js"></script>

<script src="js/tictactoe/BoardAlias.js"></script>
<script src="js/tictactoe/BoardUtilities.js"></script>
<script src="js/tictactoe/EnvironmentUI.js"></script>
<script src="js/tictactoe/LearningAgent.js"></script>
<script src="js/tictactoe/Memory.js"></script>
<script src="js/tictactoe/MemoryIO.js"></script>
<script src="js/tictactoe/Rotation.js"></script>
<script src="js/tictactoe/SimpleAgent.js"></script>
<script src="js/tictactoe/TicTacToe.js"></script>
</head>
<body>
	<table id="board" class="board">
		<caption id="status"></caption>
		<tr>
			<td id="cell0" class="cell-bottom cell-right">&nbsp;</td>
			<td id="cell1" class="cell-left cell-bottom cell-right">&nbsp;</td>
			<td id="cell2" class="cell-left cell-bottom">&nbsp;</td>
		</tr>
		<tr>
			<td id="cell3" class="cell-top cell-bottom cell-right">&nbsp;</td>
			<td id="cell4" class="cell-center">&nbsp;</td>
			<td id="cell5" class="cell-left cell-top cell-bottom">&nbsp;</td>
		</tr>
		<tr>
			<td id="cell6" class="cell-top cell-right">&nbsp;</td>
			<td id="cell7" class="cell-left cell-top cell-right">&nbsp;</td>
			<td id="cell8" class="cell-left cell-top">&nbsp;</td>
		</tr>
	</table>
	<p />
	<table class="statistics">
		<tr>
			<th class="statistics-cell">X Wins</th>
			<th class="statistics-cell">Draws</th>
			<th class="statistics-cell">O Wins</th>
		</tr>
		<tr>
			<td id="xWins" class="statistics-cell">0</td>
			<td id="draws" class="statistics-cell">0</td>
			<td id="oWins" class="statistics-cell">0</td>
		</tr>
	</table>
	<script>
        "use strict";

        var LOGGER = new Logger();
        LOGGER.setTraceEnabled(false);
        LOGGER.setDebugEnabled(false);

        var memory;
        var isStartingFresh = true;

        if (isStartingFresh)
        {
            MemoryIO.clear();
            memory = new Memory();
        }
        else
        {
            memory = MemoryIO.load();
        }

        var firstAgent = new LearningAgent("X", memory);
        var secondAgent = new LearningAgent("o", memory);
        var delay = 300;

        var game = new TicTacToe(memory, firstAgent, secondAgent, delay,
                gameOverCallback);
        var environmentUI = new EnvironmentUI(game);
        game.play();

        var maxCount = 100;
        var count = 1;

        function gameOverCallback()
        {
            LOGGER.info(count + " Game over callback");
            MemoryIO.store(memory);

            count++;

            if (count <= maxCount)
            {
                game.play();
            }
            else
            {
                var value = JSON.stringify(memory.boardToStatistics, null, 3);
                LOGGER.info("memory.boardToStatistics = " + value);
            }
        }
    </script>
</body>
</html>