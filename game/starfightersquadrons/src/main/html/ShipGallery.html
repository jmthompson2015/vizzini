<!DOCTYPE html>
<html lang="en">
<head>
  <title>Ship Gallery</title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="../css/style.css">

  <script src="../../../../../coreweb/lib/react/react-15.5.4.min.js"></script>
  <script src="../../../../../coreweb/lib/react-dom/react-dom-15.5.4.min.js"></script>
  <script src="../../../../../coreweb/lib/react-redux/react-redux-5.0.5.min.js"></script>
  <script src="../../../../../coreweb/lib/reactable/reactable-0.14.1.js"></script>
  <script src="../../../../../coreweb/lib/redux/redux-3.6.0.min.js"></script>
  <script src="../../../../../coreweb/lib/require/require-2.3.3.min.js" data-main="../js/Team"></script>

  <script src="../../../../../coreweb/src/main/js/util/JavaScriptAugments.js"></script>
  <script src="../../../../../coreweb/src/main/js/util/Logger.js"></script>
  <script src="../../../../../coreweb/src/main/js/util/InputValidator.js"></script>
  <script src="../../../../../coreweb/src/main/js/util/ArrayAugments.js"></script>
  <script src="../../../../../coreweb/src/main/js/util/StringAugments.js"></script>

  <style>
    .galleryTable {
      background-color: black;
      border-collapse: collapse;
      display: inline-block;
      vertical-align: top;
    }

    .galleryCell {
      border: 3px solid lightGray;
      padding: 5px;
      text-align: center;
    }

    .galleryShipCell {
      padding: 5px;
    }

    .shipName {
      color: white;
    }
  </style>
</head>
<body>
  <h1>Starfighter Squadrons Ship Gallery</h1>
  <h2>Imperial</h2>
  <div id="imperialShips"></div>
  <h2>Rebel</h2>
  <div id="rebelShips"></div>
  <h2>Scum &amp; Villainy</h2>
  <div id="scumShips"></div>
  <h2>First Order</h2>
  <div id="firstOrderShips"></div>
  <h2>Resistance</h2>
  <div id="resistanceShips"></div>
  <script>
    "use strict";
    var LOGGER = new Logger();
    LOGGER.setTraceEnabled(false);
    LOGGER.setDebugEnabled(false);

    var resourceBase = "../resources/";
    var imageBase = resourceBase + "images/";

    require(["Pilot", "Position", "Ship", "ShipTeam", "Team", "process/Reducer", "process/SimpleAgent", "process/TokenFactory", "process/ui/ManeuverChooser",
        "process/ui/ShipActionPanel", "process/ui/ShipSilhouetteUI", "process/ui/ShipUI"
      ],
      function(Pilot, Position, Ship, ShipTeam, Team, Reducer, SimpleAgent, TokenFactory, ManeuverChooser, ShipActionPanel, ShipSilhouetteUI, ShipUI)
      {
        var imageBase2 = imageBase + "ship/";
        var store = Redux.createStore(Reducer.root);
        var ShipInstance = React.createClass(
        {
          render: function()
          {
            var agent = this.props.agent;
            var shipTeamKey = this.props.shipTeamKey;

            var cell0, cell1, cell2, cell3;

            var shipTeam = ShipTeam.properties[shipTeamKey];
            var filename = imageBase2 + shipTeam.image;
            var pilotKey = Pilot.valuesByShipTeam(shipTeamKey)[0];
            var token = TokenFactory.create(store, pilotKey, agent);

            var images = [];
            images.push(this.createShipImage(shipTeamKey, images.length));

            if (shipTeamKey === ShipTeam.IMPERIAL_TIE_BOMBER)
            {
              images.push(this.createShipImage(ShipTeam.IMPERIAL_TIE_BOMBER_VETERAN, images.length));
            }
            else if (shipTeamKey === ShipTeam.IMPERIAL_TIE_DEFENDER)
            {
              images.push(this.createShipImage(ShipTeam.IMPERIAL_TIE_DEFENDER_VETERAN, images.length));
            }
            else if (shipTeamKey === ShipTeam.IMPERIAL_TIE_INTERCEPTOR)
            {
              images.push(this.createShipImage(ShipTeam.IMPERIAL_TIE_INTERCEPTOR_ROYAL_GUARD, images.length));
              images.push(this.createShipImage(ShipTeam.IMPERIAL_TIE_INTERCEPTOR_SABER_SQUADRON, images.length));
            }
            else if (shipTeamKey === ShipTeam.REBEL_A_WING)
            {
              images.push(this.createShipImage(ShipTeam.REBEL_A_WING_ACE, images.length));
            }
            else if (shipTeamKey === ShipTeam.REBEL_B_WING)
            {
              images.push(this.createShipImage(ShipTeam.REBEL_B_WING_ACE, images.length));
            }

            var silhouette = React.createElement(ShipSilhouetteUI,
            {
              ship: shipTeam.ship,
              imageBase: imageBase,
              showName: true,
            });

            var shipActionPanel0, shipActionPanel1;

            if (shipTeamKey === ShipTeam.IMPERIAL_RAIDER_CLASS_CORVETTE ||
              shipTeamKey === ShipTeam.REBEL_CR90_CORVETTE)
            {
              shipActionPanel0 = React.createElement(ShipActionPanel,
              {
                imageBase: imageBase,
                shipActionKeys: shipTeam.ship.fore.shipActionKeys,
              });
              shipActionPanel1 = React.createElement(ShipActionPanel,
              {
                imageBase: imageBase,
                shipActionKeys: shipTeam.ship.aft.shipActionKeys,
              });
            }
            else
            {
              shipActionPanel0 = React.createElement(ShipActionPanel,
              {
                imageBase: imageBase,
                shipActionKeys: shipTeam.ship.shipActionKeys,
              });
            }

            var chooser = React.createElement(ManeuverChooser,
            {
              imageBase: imageBase,
              token: token,
              isPilotNameShown: false,
            });

            cell0 = React.DOM.td(
            {
              key: "image" + shipTeamKey,
              className: "galleryCell",
            }, images);
            cell1 = React.DOM.td(
            {
              key: "name" + shipTeamKey,
              className: "galleryCell"
            }, silhouette);

            if (shipActionPanel1 !== undefined)
            {
              cell2 = React.DOM.td(
              {
                key: "actions" + shipTeamKey,
                className: "galleryCell colorWhite"
              }, React.DOM.table(
              {
                className: "alignCenter",
              }, React.DOM.tbody(
              {}, React.DOM.tr(
                {}, React.DOM.td(
                {}, "Fore"), React.DOM
                .td(
                {}, shipActionPanel0)), React.DOM.tr(
                {}, React.DOM.td(
                {}, "Aft"),
                React.DOM.td(
                {}, shipActionPanel1)))));
            }
            else
            {
              cell2 = React.DOM.td(
              {
                key: "actions" + shipTeamKey,
                className: "galleryCell"
              }, shipActionPanel0);
            }

            cell3 = React.DOM.td(
            {
              key: "maneuvers" + shipTeamKey,
              className: "galleryCell alignBottom"
            }, chooser);

            var rows = [];
            rows.push(React.DOM.tr(
            {
              key: rows.length,
            }, cell0));
            rows.push(React.DOM.tr(
            {
              key: rows.length,
              className: "shipName"
            }, cell1));
            rows.push(React.DOM.tr(
            {
              key: rows.length,
            }, cell2));
            rows.push(React.DOM.tr(
            {
              key: rows.length,
            }, cell3));
            return React.DOM.table(
            {
              className: "galleryTable"
            }, React.DOM.tbody(
            {}, rows));
          },

          createShipImage: function(shipTeamKey, key)
          {
            var shipTeam = ShipTeam.properties[shipTeamKey];
            var shipBase = shipTeam.ship.shipBase;
            var position = new Position(shipBase.width / 2, shipBase.height / 2, 0);

            return React.createElement(ShipUI,
            {
              key: key,
              canvasId: shipTeam.name,
              imageBase: imageBase,
              position: position,
              shipTeam: shipTeam,
            });
          },
        });
        var ShipGallery = React.createClass(
        {
          render: function()
          {
            var team = this.props.team;
            var isStrict = true;
            var shipTeamKeys = ShipTeam.valuesByTeam(team, isStrict);
            var agent = new SimpleAgent("Agent", team);

            var cells = [];
            var excludes = [ShipTeam.IMPERIAL_TIE_BOMBER_VETERAN,
              ShipTeam.IMPERIAL_TIE_DEFENDER_VETERAN,
              ShipTeam.IMPERIAL_TIE_INTERCEPTOR_ROYAL_GUARD,
              ShipTeam.IMPERIAL_TIE_INTERCEPTOR_SABER_SQUADRON,
              ShipTeam.REBEL_A_WING_ACE,
              ShipTeam.REBEL_B_WING_ACE
            ];

            shipTeamKeys.forEach(function(shipTeamKey)
            {
              if (!excludes.vizziniContains(shipTeamKey))
              {
                var element = React.createElement(ShipInstance,
                {
                  key: "instance" + shipTeamKey,
                  agent: agent,
                  shipTeamKey: shipTeamKey,
                });
                cells.push(element);
              }
            });

            return React.DOM.div(
            {}, cells);
          },
        });

        var element0 = React.createElement(ShipGallery,
        {
          team: Team.IMPERIAL,
        });
        ReactDOM.render(element0, document.getElementById("imperialShips"));
        var element1 = React.createElement(ShipGallery,
        {
          team: Team.REBEL,
        });
        ReactDOM.render(element1, document.getElementById("rebelShips"));
        var element2 = React.createElement(ShipGallery,
        {
          team: Team.SCUM,
        });
        ReactDOM.render(element2, document.getElementById("scumShips"));
        var element3 = React.createElement(ShipGallery,
        {
          team: Team.FIRST_ORDER,
        });
        ReactDOM.render(element3, document.getElementById("firstOrderShips"));
        var element4 = React.createElement(ShipGallery,
        {
          team: Team.RESISTANCE,
        });
        ReactDOM.render(element4, document.getElementById("resistanceShips"));
      });
  </script>
</body>

</html>
