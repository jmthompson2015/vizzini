<!DOCTYPE html>
<html>
<head>
<title>MyTestEnvironmentUI</title>

<link rel="stylesheet" href="../../../main/css/style.css">

<script src="../../../../../../coreweb/lib/react/react-15.0.1.min.js"></script>
<script src="../../../../../../coreweb/lib/react-dom/react-dom-15.0.1.min.js"></script>
<script src="../../../../../../coreweb/lib/react-redux/react-redux-4.4.2.min.js"></script>
<script src="../../../../../../coreweb/lib/redux/redux-3.4.0.min.js"></script>
<script src="../../../../../../coreweb/lib/require/require-2.1.22.js" data-main="../../../main/js/Sphere"></script>

<script src="../../../../../../coreweb/src/main/js/util/JavaScriptAugments.js"></script>
<script src="../../../../../../coreweb/src/main/js/util/Logger.js"></script>
<script src="../../../../../../coreweb/src/main/js/util/InputValidator.js"></script>
<script src="../../../../../../coreweb/src/main/js/util/ArrayAugments.js"></script>

<style>
.environmentUI {
    background-color: LightGray,
}

.activeQuestUI {
    background-color: Red,
}

.activeLocationUI {
    background-color: Green,
}

.stagingAreaUI {
    background-color: Blue,
}
</style>

</head>
<body>
	<div id="panel"></div>
	<script>
        "use strict";
        var LOGGER = new Logger();

        var resourceBase = "../../../main/resources/";
        var imageBase = resourceBase + "images/";

        require([ "AllyCard", "CardSet", "EnemyCard", "HeroCard", "LocationCard", "Phase", "QuestCard", "Sphere",
                "game/Agent", "game/CardInstance", "game/ui/EnvironmentUI" ], function(AllyCard, CardSet, EnemyCard,
                HeroCard, LocationCard, Phase, QuestCard, Sphere, Agent, CardInstance, EnvironmentUI)
        {
            var activeLocation = CardInstance.location(LocationCard.OLD_FOREST_ROAD);
            var activeQuest = CardInstance.quest(QuestCard.FLIES_AND_SPIDERS);
            var stagingArea = [];
            stagingArea.push(CardInstance.enemy(EnemyCard.FOREST_SPIDER));
            stagingArea.push(CardInstance.location(LocationCard.FOREST_GATE));
            stagingArea.push(CardInstance.enemy(EnemyCard.DOL_GULDUR_BEASTMASTER));
            var agents = [];
            agents.push(createAgent0());
            agents.push(createAgent1());

            var element = React.createElement(EnvironmentUI,
            {
                round: 2,
                phaseKey: Phase.RESOURCE_START,
                firstAgentId: 0,
                activeAgentId: 1,
                activeLocation: activeLocation,
                activeQuest: activeQuest,
                stagingArea: stagingArea,
                agents: agents,
            });
            ReactDOM.render(element, document.getElementById("panel"));

            function createAgent0()
            {
                var id = 0;
                var name = "Aaron";
                var heroes = [];
                heroes.push(CardInstance.hero(HeroCard.ARAGORN_LEADERSHIP));
                heroes.push(CardInstance.hero(HeroCard.THEODRED));
                heroes.push(CardInstance.hero(HeroCard.DENETHOR));
                var playerCards = [];
                AllyCard.values().forEach(
                        function(cardKey)
                        {
                            var card = AllyCard.properties[cardKey];
                            if (card.set === CardSet.CORE &&
                                    ([ Sphere.LEADERSHIP, Sphere.LORE, Sphere.NEUTRAL ].vizziniContains(card.sphere)))
                            {
                                playerCards.push(CardInstance.ally(cardKey));
                            }
                        });
                var agent = Agent(id, name, heroes, playerCards);

                agent.engagementArea.push(CardInstance.enemy(EnemyCard.FOREST_SPIDER));

                // Deal 6 cards.
                for (var i = 0; i < 6; i++)
                {
                    var card = playerCards.shift();
                    agent.hand.push(card);
                }

                return agent;
            }

            function createAgent1()
            {
                var id = 1;
                var name = "Bruce";
                var heroes = [];
                heroes.push(CardInstance.hero(HeroCard.GIMLI));
                heroes.push(CardInstance.hero(HeroCard.THALIN));
                heroes.push(CardInstance.hero(HeroCard.EOWYN));
                var playerCards = [];
                AllyCard.values().forEach(
                        function(cardKey)
                        {
                            var card = AllyCard.properties[cardKey];
                            if (card.set === CardSet.CORE &&
                                    ([ Sphere.SPIRIT, Sphere.TACTICS, Sphere.NEUTRAL ].vizziniContains(card.sphere)))
                            {
                                playerCards.push(CardInstance.ally(cardKey));
                            }
                        });
                playerCards.vizziniShuffle();
                var agent = Agent(id, name, heroes, playerCards);

                agent.engagementArea.push(CardInstance.enemy(EnemyCard.FOREST_SPIDER));

                // Deal 6 cards.
                for (var i = 0; i < 6; i++)
                {
                    var card = playerCards.shift();
                    agent.hand.push(card);
                }

                return agent;
            }
        });
    </script>
</body>
</html>
